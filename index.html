<!DOCTYPE html>
<html>
<head>
  <title>Dropbox Database Example</title>
</head>
<body>
  <h1>Dropbox Database Example</h1>

  <div id="messages"></div>

  <input type="text" id="newMessage" placeholder="Ingresa un nuevo mensaje">
  <button onclick="saveMessage()">Guardar Mensaje</button>

  <script>
    // Reemplaza con tu token de acceso a Dropbox
    const ACCESS_TOKEN = 'czs5j78prk9f9b0';

    // Ruta al archivo de texto en Dropbox
    const FILE_PATH = '/ChatSocial.txt';

    // Funci칩n para leer los mensajes del archivo de Dropbox
    function readMessages() {
      fetch('https://content.dropboxapi.com/2/files/download', {
        headers: {
          'Dropbox-API-Arg': JSON.stringify({
            'path': FILE_PATH
          }),
          'Authorization': 'Bearer ' + ACCESS_TOKEN
        }
      })
      .then(response => response.text())
      .then(data => {
        // Mostrar los mensajes en la p치gina
        document.getElementById('messages').textContent = data;
      })
      .catch(error => {
        console.error('Error al leer los mensajes:', error);
      });
    }

    // Funci칩n para guardar un nuevo mensaje en Dropbox
    function saveMessage() {
      const newMessage = document.getElementById('newMessage').value;
      if (newMessage.trim() !== '') {
        fetch('https://content.dropboxapi.com/2/files/upload', {
          method: 'POST',
          headers: {
            'Dropbox-API-Arg': JSON.stringify({
              'path': FILE_PATH,
              'mode': 'overwrite',
              'autorename': false,
              'mute': false
            }),
            'Content-Type': 'application/octet-stream',
            'Authorization': 'Bearer ' + ACCESS_TOKEN
          },
          body: newMessage
        })
        .then(response => {
          if (response.ok) {
            // Limpiar el campo de entrada
            document.getElementById('newMessage').value = '';
            // Volver a leer los mensajes
            readMessages();
          } else {
            console.error('Error al guardar el mensaje:', response.status);
          }
        })
        .catch(error => {
          console.error('Error al guardar el mensaje:', error);
        });
      }
    }

    // Leer los mensajes al cargar la p치gina
    readMessages();
  </script>
</body>
</html>
